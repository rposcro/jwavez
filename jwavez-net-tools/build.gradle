/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'com.jwavez.java-conventions'
}

dependencies {
    implementation project(':jwavez-core')
    implementation project(':jwavez-serial')
    implementation 'org.slf4j:slf4j-api:1.7.25'
    implementation 'org.slf4j:jcl-over-slf4j:1.7.25'
    implementation 'ch.qos.logback:logback-classic:1.1.7'
    implementation 'commons-cli:commons-cli:1.4'

    testImplementation 'cglib:cglib-nodep:3.2.5'
    testImplementation 'org.spockframework:spock-core:1.1-groovy-2.4'
    testImplementation 'org.codehaus.groovy:groovy-all:2.4.6'

    compileOnly 'org.projectlombok:lombok:1.18.20'
    annotationProcessor 'org.projectlombok:lombok:1.18.20'
    testCompileOnly 'org.projectlombok:lombok:1.18.20'
    testAnnotationProcessor 'org.projectlombok:lombok:1.18.20'
}

description = 'jwavez-net-tools'

jar {
    manifest {
        attributes "Main-Class": "com.rposcro.jwavez.tools.cli.ZWaveCLI"
    }
    from {
        configurations.runtimeClasspath.collect {
            exclude "META-INF/*"
            it.isDirectory() ? it : zipTree(it)
        }
    }
}

task _packCreateDir {
    doLast {
        mkdir "$buildDir/jwz"
    }
}

task _packCopyArchives(type: Copy) {
    dependsOn _packCreateDir
    from(jar.archiveFile) {
        rename { fileName -> jar.archiveBaseName.get() << ".jar" }
    }
    from("src/main/bash") {
        include "*"
    }
    into "$buildDir/jwz"
}

task pack {
    dependsOn _packCopyArchives
}

task deployLocal(type: Copy) {
    dependsOn _packCopyArchives
    from("$buildDir/jwz") {
        include "*"
    }
    into "file://" + System.properties["user.home"] + "/bin"
}
